library(dplyr)
num_trials <- 10e6
simulations <- data_frame(
true_average = rbeta(num_trials, 81, 219),
hits = rbinom(num_trials, 300, true_average)
)
View(simulations)
View(simulations)
library(dplyr)
num_trials <- 10e6
simulations <- data_frame(
true_average = rbeta(num_trials, 81, 219),
hits = rbinom(num_trials, 300, true_average)
)
simulations
hits_100 <- simulations %<%
filter(hits == 100)
hits_100 <- simulations %>%
filter(hits == 100)
hit_100
hits_100 <- simulations %>%
filter(hits == 100)
hit_100
hit_100 <- simulations %>%
filter(hits == 100)
hit_100
simulations %>%
filter(hits %in% c(60, 80, 100)) %>%
ggplot(aes(true_average, color = factor(hits))) +
geom_density() +
labs(x = "True average of players with H hits / 300 at-bats",
color = "H")
library(ggplot2)
simulations %>%
filter(hits %in% c(60, 80, 100)) %>%
ggplot(aes(true_average, color = factor(hits))) +
geom_density() +
labs(x = "True average of players with H hits / 300 at-bats",
color = "H")
library(tidyr)
library(Lahman) # Baseball dataset
Batting
Example1 <- Batting
View(Example1)
career <- Batting %>%
filter(AB > 0) %>%
anti_join(Pitching, by = "playerID") %>%
group_by(playerID) %>%
summarize(H = sum(H), AB = sum(AB)) %>%
mutate(average = H / AB)
View(career)
Master %>%
tbl_df() %>%
dplyr::select(playerID, nameFirst, nameLast) %>%
unite(name, nameFirst, nameLast, sep = " ") %>%
inner_join(career, by = "playerID")
career <- Master %>%
tbl_df() %>%
dplyr::select(playerID, nameFirst, nameLast) %>%
unite(name, nameFirst, nameLast, sep = " ") %>%
inner_join(career, by = "playerID") %>%
dplyr::select(-playerID)
View(career)
View(career)
career %>%
filter(AB > 500) %>%
ggplot(aes(average)) +
geom_histogram() +
labs(x = "Average")
library(stats4)
career_filtered <- career %>%
filter(AB > 500)
View(career_filtered)
ll <- function(alpha, beta) {
x <- career_filtered$H
total <- career_filtered$AB
-sum(VGAM::dbetabinom.ab(x, total, alpha, beta, log = TRUE))
}
library(VGAM)
install.packages("VGAM")
?stats4
m <- mle(ll, start = list(alpha = 1, beta = 10), method = "L-BFGS-B",
lower = c(0.0001, .1))
library(VGAM)
install.packages("VGAM")
